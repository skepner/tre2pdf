# tre2pdf
Set of tools to generate pdf of phylogenetic tree

## Processing

Note: <input.json> and <output.json> can be replaced with - to allow reading/writing from/to stdin/stdout.

* Convert tree in the newick format to json supported by this tools.

        ./dist/newick2json <input.tre> <output.json>

* Add continent information.

    Uses acmacs API to parse sequence names and obtain continent information for them.

        ./scripts/tre-continent --acmacs=https://localhost:1168 <input.json> <output.json>

* Add clade information

    sequences.fasta is the data that was used to make initial tree in the newick format.

        ./scripts/tre-clade <input.json> <sequences.fasta> <clade-desc.json> <output.json>

    Sample clade-desc.json:

        {
            "H3": {
                "comment": "158N, 159F -> 3C, 159Y -> 3c2a, 159S -> 3c3a, 160S -> gly, 160T -> gly, 160x -> no gly",
                "clades": [
                    {"clade": "3C3", "positions": [{"pos": 158, "aa": "N"}, {"pos": 159, "aa": "F"}]},
                    {"clade": "3C2a", "positions": [{"pos": 158, "aa": "N"}, {"pos": 159, "aa": "Y"}]},
                    {"clade": "3C3a", "positions": [{"pos": 158, "aa": "N"}, {"pos": 159, "aa": "S"}]}
                ]
            },
            "B": {
                "comment": "165N - Y2, 165Y - Y3",
                "clades": [
                    {"clade": "Y2", "positions": [{"pos": 165, "aa": "N"}]},
                    {"clade": "Y3", "positions": [{"pos": 165, "aa": "Y"}]}
                ]
            }
        }

* Generate pdf.

        ./dist/tre2pdf --continents --clades <input.json> <output.pdf>

* Do everything using pipe.

        ./dist/newick2json <input.tre> - | ./scripts/tre-continent --acmacs=https://localhost:1168 - - | ./scripts/tre-clade - <sequences.fasta> <clade-desc.json> - | ./dist/tre2pdf --continents --clades - <output.pdf>

* Adjusting various settings.

    Program generates "_settings" key in the output json. It is
    generated by newick2json and it is not touched by tre-continent,
    tre-clade. You may edit various settings, some of them could be
    set ot negative numbers, then program uses defaults or
    re-calculates those values.
